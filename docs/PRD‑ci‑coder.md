---

## 2 · PRD‑ci‑coder.md  (drop into `/docs` or `/product`)

```md
# PRD — CI‑Coder
*A coding‑assistant LLM for the Cognitive Infrastructure project*

| Item | Detail |
|------|--------|
| **Author** | Rashid Azarang Esfandiari |
| **Maintainer** | Core Engineering Guild |
| **Status** | Draft v1.0 |
| **Last Updated** | 2025‑04‑16 |

---

<!-- Migration Status: Complete -->

## 1 · Purpose

CI‑Coder is an AI pair‑programmer that lives inside the IDE (VS Code primary),
understands the repository structure, and automates routine engineering tasks:
validation scripts, GitHub Actions, schema tweaks, and small utility CLIs.  
It removes cognitive ballast so human engineers can focus on framework design.

---

## 2 · Scope

| In‑Scope | Out‑of‑Scope |
|----------|--------------|
| Generate / refactor shell, JS/TS, YAML | Heavy data ETL pipelines |
| Auto‑create GitHub branches & PRs | Full‑stack React components |
| Lint & test fixes | UI prototyping |
| CI workflow suggestions | Production infra provisioning |

---

## 3 · User Stories

| # | As a | I want to | So that |
|---|------|----------|---------|
| 1 | Maintainer | get an auto‑generated GitHub Action when I add a JSON schema | the pipeline validates every PR |
| 2 | Contributor | ask “fix links” in chat | broken internal refs are patched instantly |
| 3 | Dev | scaffold a Jest test with one command | new utilities are covered from day‑1 |

---

## 4 · Functional Requirements

1. **IDE Extension**  
   - Loads project tree + open buffers.  
   - Exposes `/ci` slash‑commands (e.g., `/ci action lint`).

2. **Contextual Code Gen**  
   - Reads `ci-schema.json`; suggests AJV validate snippets.  
   - Generates or updates GitHub Actions YAML with best practices.

3. **Repo Ops**  
   - Creates branches `ci-coder/<slug>`; never pushes to `main`.  
   - Opens PR with template, auto‑labels `ci‑coder`.

4. **Validation**  
   - Runs `npm test`, markdown‑lint, ajv schema check before commit.

5. **Security & Permissions**  
   - Uses fine‑grained GitHub PAT (`contents:write`, `pull_requests:write`).  
   - Scrubs generated code for secrets.

6. **Logging & Explainability**  
   - Adds comment banner at top of each generated file:  
     `// generated by CI‑Coder on YYYY‑MM‑DD – rationale: <one‑line>`.

---

## 5 · Non‑Functional Requirements

| Metric | Target |
|--------|--------|
| Latency | ≤1 s first suggestion; ≤5 s large refactor |
| Uptime | 99 % during working hours |
| Mean Review Changes | <2 minor comments per CI‑Coder PR |

---

## 6 · Success Metrics (KPIs)

1. **Dev Efficiency** – 25 % reduction in time spent on boilerplate commits.  
2. **PR Throughput** – CI‑Coder PRs merged / month ≥ 5.  
3. **CI Failures** – <5 % of CI‑Coder PRs fail automated checks post‑merge.

---

## 7 · Milestones & Timeline

| Milestone | Target Date | Deliverable |
|-----------|-------------|-------------|
| **M0** | +2 weeks | VS Code extension skeleton; chat panel loads context |
| **M1** | +4 weeks | Branch/PR creation; GitHub Action generator |
| **M2** | +8 weeks | Jest test scaffolder; “fix schema” command |
| **M3** | +12 weeks | Automated link‑checker fix & smart refactor engine |

---

## 8 · Open Questions

1. Should CI‑Coder auto‑resolve CI‑Writer lint failures?  
2. Preferred local model fallback if API rate‑limited?  
3. How to version CI‑Coder itself—semantic tags or hash?

---

## 9 · Appendix A — Slash‑Command Catalog (MVP)

| Command | Action |
|---------|--------|
| `/ci action lint` | Generate lint GitHub Action |
| `/ci schema validate` | Insert AJV validate script |
| `/ci jest scaffold <path>` | Add Jest test skeleton |
| `/ci links fix` | Scan / auto‑patch Markdown links |

---

> **Governance Rule**: every CI‑Coder commit must pass `npm test && ajv` and
> receive one human approval. No exceptions.